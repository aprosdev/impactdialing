<% if @csv_validator.errors.any? %>
<div class="callout alert clearfix">
  <% @csv_validator.errors.each do |error| %>
  <p><strong><%= error %></strong></p>
  <% end %>
</div>
<% else %>
  <p>Please map your headers to the appropriate fields below.</p>
  <p>
    You should map the ID field to a unique ID generated by the database you get your records from.
    When uploading another list, this ID field will be used to de-duplicate records,
    so that you can update leads' information in your campaign without creating new records.
  </p>
  <table>
    <tr>
      <th>Header from your spreadsheet</th>
      <th>Field in the dialer</th>
      <th>Example data</th>
    </tr>
    <% @csv_validator.csv_column_headers.each_with_index do |csv_header, index| %>
      <% selected = selected_system_or_custom_header_for(csv_header, @campaign.account, @use_custom_ids) %>
      <% css_id = "csv_to_system_map_#{csv_header.gsub(/[^\w]/, '').underscore.strip}" %>
      <tr>
        <td>
          <label for="<%= css_id %>">
            <%= csv_header %>
          </label>
        </td>
        <td>
          <%= select_tag "voter_list[csv_to_system_map[#{csv_header}]]",
              options_for_select(system_column_headers(csv_header, @campaign.account, @use_custom_ids), selected),
              class: "select-column-mapping", id: css_id %>
        </td>
        <td><%= @csv_validator.first_row[index] %></td>
      </tr>
    <% end %>
  </table>
<% end %>
